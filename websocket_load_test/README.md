# WebSocket Load Testing Project

## Описание
Проект для тестирования производительности WebSocket сервера под нагрузкой.

## Запуск через Docker (Рекомендуется)

### Шаг 1: Сборка и запуск контейнера
```bash
cd websocket_load_test
docker-compose up -d --build
```

### Шаг 2: Заход в контейнер
```bash
docker exec -it websocket_load_test bash
```

### Шаг 3: Запуск тестирования (внутри контейнера)

**Вариант A: Автоматический тест**
```bash
./run_test.sh
```

**Вариант B: Ручной запуск**

1. **Терминал 1** (внутри контейнера) - WebSocket сервер:
```bash
python3 websocket.py
```

2. **Терминал 2** (новый терминал на хосте) - Artillery:
```bash
docker exec -it websocket_load_test bash
artillery run test_config.yml
```

3. **Терминал 3** (новый терминал на хосте) - CPU/память:
```bash
docker exec -it websocket_load_test htop
```

4. **Терминал 4** (новый терминал на хосте) - Сеть:
```bash
docker exec -it websocket_load_test bmon
```

### Шаг 4: Остановка контейнера
```bash
docker-compose down
```

## Локальная установка (без Docker)

### Установка зависимостей

#### Python зависимости
```bash
pip3 install -r requirements.txt
```

#### Artillery (инструмент нагрузочного тестирования)
```bash
npm install -g artillery
```

#### Утилиты мониторинга (Ubuntu/Debian)
```bash
sudo apt update
sudo apt install htop bmon
```

#### Утилиты мониторинга (macOS)
```bash
brew install htop bmon
```

## Варианты тестирования

### Вариант 1: Использовать готовый сервер
Используйте файл `websocket.py` - он уже готов к работе.

### Вариант 2: Написать свой сервер
1. Отредактируйте файл `websocket_empty.py`
2. Запустите его вместо готового сервера
3. Протестируйте нагрузкой

## Что наблюдать

- **htop**: Загрузка CPU, использование памяти
- **bmon**: Сетевой трафик (входящий/исходящий)
- **Artillery**: RPS (requests per second), время ответа, ошибки
- **Сервер**: Количество соединений, обработанных сообщений

## Параметры нагрузки

По умолчанию тест:
- Длится 60 секунд
- Начинает с 5 соединений в секунду
- Постепенно увеличивает до 100 соединений в секунду
- Каждое соединение отправляет 1000 сообщений "ping"
- Пауза между сообщениями: 0.05 секунды

## Цель эксперимента
Увидеть, как WebSocket сервер нагружает ресурсы системы при высокой нагрузке. 